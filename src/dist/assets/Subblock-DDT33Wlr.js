import{_ as J,u as ae,r as E,l as x,c as a,b as s,d as e,h as $,n as P,t as m,F as B,m as se,p as ne,v as G,q as ie,o as K,i as q,s as z,x as oe,y as ee,f as Q,z as ue,A as H,j as Y,B as re,C as ce,D as ve,a as de,e as W,w as te,g as pe,k as le}from"./index-CQU0DmQk.js";import{P as me}from"./PostCard-AwN3vA5N.js";const fe={class:"vote-info"},ge={class:"vote-type-text"},he={class:"vote-counts-simple"},ye={class:"user-section"},_e={class:"user-info initiator-user"},be=["src","alt"],Ee={class:"user-details"},ke={class:"user-name"},Ce={key:0,class:"user-section"},$e={class:"user-info target-user"},we=["src","alt"],Te={class:"user-details"},Se={class:"user-name"},Ie={key:0,class:"update-details-simple"},Ue={key:0,class:"update-item"},Me={class:"update-content"},Ve={key:1,class:"update-item"},Pe={key:1,class:"action-details-simple"},Ae={key:0,class:"reason-item"},Re={class:"reason-content"},De={class:"progress-bar-wrapper"},Ne={class:"progress-bar-dual"},xe={key:1,class:"progress-placeholder"},Le={class:"progress-stats"},Oe={class:"positive-percentage"},Be={class:"negative-percentage"},Fe={class:"vote-buttons-reference"},He=["title","disabled"],je={key:0},Xe=["title","disabled"],qe={key:0},Ge={__name:"VoteCard",props:{vote:{type:Object,required:!0},spaceId:{type:Number,required:!0},isCompact:{type:Boolean,default:!1},isRefreshing:{type:Boolean,default:!1}},emits:["vote-cast","vote-updated"],setup(l,{emit:A}){const d=l,U=A,M=ae(),p=E(!1),k=x(()=>({PIN_COMMENT:"ç½®é¡¶è¯„è®º",UNPIN_COMMENT:"å–æ¶ˆç½®é¡¶è¯„è®º",DELETE_COMMENT:"åˆ é™¤è¯„è®º",ARCHIVE_POST:"å½’æ¡£å¸–å­",UNARCHIVE_POST:"å–æ¶ˆå½’æ¡£å¸–å­",DELETE_POST:"åˆ é™¤å¸–å­",UPDATE_SPACE:"ä¿®æ”¹ç©ºé—´ä¿¡æ¯",EXPEL_USER:"é©±é€ç”¨æˆ·",MUTE_USER:"ç¦è¨€ç”¨æˆ·"})[d.vote.vote.voteType]||d.vote.vote.voteType),f=x(()=>{const n=["UPDATE_SPACE","EXPEL_USER","MUTE_USER"],v=["DELETE_POST","ARCHIVE_POST"];return n.includes(d.vote.vote.voteType)?"high":v.includes(d.vote.vote.voteType)?"medium":"normal"}),b=x(()=>{const n=d.vote.vote.positiveCount+d.vote.vote.negativeCount;return n===0?0:Math.round(d.vote.vote.positiveCount/n*100)}),C=x(()=>b.value>=60?"success":b.value>=40?"warning":"danger"),_=x(()=>new Date(d.vote.vote.endAt)<new Date),i=x(()=>{var n;return((n=d.vote.opinion)==null?void 0:n.opinionStatus)||null});x(()=>i.value!==null);const N=n=>i.value?!!(n&&i.value==="POSITIVE"||!n&&i.value==="NEGATIVE"):!1,y=n=>{const v=new Date(n).getTime(),I=new Date().getTime(),w=v-I;if(w<=0)return"å·²ç»“æŸ";const u=Math.floor(w/(1e3*60*60*24)),o=Math.floor(w%(1e3*60*60*24)/(1e3*60*60)),g=Math.floor(w%(1e3*60*60)/(1e3*60));return u>0?`${u}å¤©${o}å°æ—¶`:o>0?`${o}å°æ—¶${g}åˆ†é’Ÿ`:g>0?`${g}åˆ†é’Ÿ`:"å³å°†ç»“æŸ"},S=n=>{const v=new Date(n).getTime(),I=new Date().getTime(),w=v-I;if(w<=0)return"expired";const u=Math.floor(w/(1e3*60*60));return u<=1?"urgent":u<=24?"warning":"normal"},V=n=>({UPDATE_SPACE:"ğŸ ",EXPEL_USER:"ğŸš«",MUTE_USER:"ğŸ”‡",DELETE_POST:"ğŸ—‘ï¸",ARCHIVE_POST:"ğŸ“¦",UNARCHIVE_POST:"ğŸ“¦",DELETE_COMMENT:"ğŸ—‘ï¸",PIN_COMMENT:"ğŸ“Œ",UNPIN_COMMENT:"ğŸ“Œ"})[n]||"ğŸ—³ï¸",L=n=>({UPDATE_SPACE:"space-update",EXPEL_USER:"expel",MUTE_USER:"mute",DELETE_POST:"delete",ARCHIVE_POST:"archive",UNARCHIVE_POST:"unarchive",DELETE_COMMENT:"delete",PIN_COMMENT:"pin",UNPIN_COMMENT:"unpin"})[n]||"default",O=async n=>{var R;if(!M.isAuthenticated||p.value||_.value||d.isRefreshing)return;const v=new Date(d.vote.vote.startAt);new Date-v<1e3&&await new Promise(T=>setTimeout(T,500));const u=i.value,o=d.vote.vote.positiveCount,g=d.vote.vote.negativeCount;try{p.value=!0;const T=n?"POSITIVE":"NEGATIVE";let D="";i.value===null?D="first_vote":i.value===T?D="cancel_vote":D="switch_vote";const X=((R=M.user)==null?void 0:R.userId)===d.vote.vote.initiator;j(n);const Z=await G.castVote({id:d.vote.vote.id,isPositive:n},!1);if(Z.success){U("vote-cast",{voteId:d.vote.vote.id,isPositive:n,previousStatus:u,isInitiator:X,changeType:D,success:!0,message:F(D,n)});const aa=F(D,n)}else console.error("æŠ•ç¥¨å¤±è´¥ - æœåŠ¡å™¨è¿”å›å¤±è´¥çŠ¶æ€ï¼Œå›æ»šæœ¬åœ°çŠ¶æ€:",Z),h(u,o,g),U("vote-cast",{voteId:d.vote.vote.id,isPositive:n,success:!1,message:Z.message||"æŠ•ç¥¨å¤±è´¥"})}catch(T){console.error("æŠ•ç¥¨æ“ä½œå¤±è´¥:",T),h(u,o,g);let D="æŠ•ç¥¨å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";T.message&&(T.message.includes("401")?D="è¯·å…ˆç™»å½•":T.message.includes("403")?D="æ‚¨æ²¡æœ‰æƒé™è¿›è¡ŒæŠ•ç¥¨":T.message.includes("404")&&(D="æŠ•ç¥¨ä¸å­˜åœ¨æˆ–å·²è¿‡æœŸ")),console.error("ç”¨æˆ·é”™è¯¯æç¤º:",D),U("vote-cast",{voteId:d.vote.vote.id,isPositive:n,success:!1,message:D})}finally{p.value=!1}},F=(n,v)=>{const I=v?"æ”¯æŒ":"åå¯¹";switch(n){case"first_vote":return`å·²æŠ•${I}ç¥¨`;case"cancel_vote":return`å·²å–æ¶ˆ${I}ç¥¨`;case"switch_vote":return`å·²æ”¹ç¥¨ä¸º${I}`;default:return`${I}æŠ•ç¥¨æˆåŠŸ`}},j=n=>{const v=i.value,I=n?"POSITIVE":"NEGATIVE";let w=null;v==="POSITIVE"&&n||v==="NEGATIVE"&&!n?w=null:w=I,v==="POSITIVE"?d.vote.vote.positiveCount-=1:v==="NEGATIVE"&&(d.vote.vote.negativeCount-=1),w==="POSITIVE"?d.vote.vote.positiveCount+=1:w==="NEGATIVE"&&(d.vote.vote.negativeCount+=1),d.vote.opinion?(d.vote.opinion.opinionStatus=w,d.vote.opinion.updatedAt=new Date().toISOString()):d.vote.opinion={mergeId:d.vote.vote.id,opinionStatus:w,updatedAt:new Date().toISOString()}},h=(n,v,I)=>{d.vote.opinion&&(d.vote.opinion.opinionStatus=n),d.vote.vote.positiveCount=v,d.vote.vote.negativeCount=I},t=n=>(n==null?void 0:n.avatar)||"/default-avatar.png",c=(n,v)=>!n||n.opinionStatus===null?v?"æŠ•æ”¯æŒç¥¨":"æŠ•åå¯¹ç¥¨":v?n.opinionStatus==="POSITIVE"?"å–æ¶ˆæ”¯æŒ":"æ”¹ä¸ºæ”¯æŒ":n.opinionStatus==="NEGATIVE"?"å–æ¶ˆåå¯¹":"æ”¹ä¸ºåå¯¹",r=()=>{const n=Number(d.vote.vote.positiveCount)||0,v=Number(d.vote.vote.negativeCount)||0,I=n+v;if(I===0)return{positive:0,negative:0};const w=Math.round(n/I*100),u=100-w;return{positive:w,negative:u}};return(n,v)=>{var I,w,u,o,g,R;return s(),a("div",{class:P(["vote-card",{expired:_.value,[`importance-${f.value}`]:!0,compact:l.isCompact}])},[e("div",{class:P(["vote-header",{compact:l.isCompact}])},[e("div",{class:P(["vote-type-badge",L(l.vote.vote.voteType)])},m(V(l.vote.vote.voteType)),3),e("div",fe,[e("div",ge,m(k.value),1),e("div",he," æ”¯æŒ"+m(l.vote.vote.positiveCount)+" / åå¯¹"+m(l.vote.vote.negativeCount),1)]),e("div",{class:P(["time-remaining-badge",S(l.vote.vote.endAt)])},m(y(l.vote.vote.endAt)),3)],2),e("div",{class:P(["vote-users-info",{compact:l.isCompact}])},[e("div",ye,[v[2]||(v[2]=e("div",{class:"user-section-title"},"å‘èµ·è€…",-1)),e("div",_e,[e("img",{src:t(l.vote.initiator),alt:(I=l.vote.initiator)==null?void 0:I.nickname,class:"user-avatar"},null,8,be),e("div",Ee,[e("span",ke,m(((w=l.vote.initiator)==null?void 0:w.nickname)||((u=l.vote.initiator)==null?void 0:u.username)||"æœªçŸ¥ç”¨æˆ·"),1)])])]),l.vote.vote.voteType==="EXPEL_USER"||l.vote.vote.voteType==="MUTE_USER"?(s(),a("div",Ce,[v[3]||(v[3]=e("div",{class:"user-section-title target-title"},"æŠ•ç¥¨å¯¹è±¡",-1)),e("div",$e,[e("img",{src:t(l.vote.relatedUser),alt:(o=l.vote.relatedUser)==null?void 0:o.nickname,class:"user-avatar"},null,8,we),e("div",Te,[e("span",Se,m(((g=l.vote.relatedUser)==null?void 0:g.nickname)||((R=l.vote.relatedUser)==null?void 0:R.username)||"æœªçŸ¥ç”¨æˆ·"),1)])])])):$("",!0)],2),e("div",{class:P(["vote-details-simple",{compact:l.isCompact}])},[l.vote.vote.voteType==="UPDATE_SPACE"?(s(),a("div",Ie,[l.vote.vote.first?(s(),a("div",Ue,[v[4]||(v[4]=e("span",{class:"update-label"},"ğŸ“ æ–°æè¿°ï¼š",-1)),e("span",Me,m(l.isCompact&&l.vote.vote.first.length>40?l.vote.vote.first.substring(0,40)+"...":l.vote.vote.first),1)])):$("",!0),l.vote.vote.second&&l.vote.vote.second!=="old"?(s(),a("div",Ve,v[5]||(v[5]=[e("span",{class:"update-label"},"ğŸ“· å¤´åƒï¼š",-1),e("span",{class:"update-content"},"æ›´æ¢ç©ºé—´å¤´åƒ",-1)]))):$("",!0)])):l.vote.vote.voteType==="EXPEL_USER"||l.vote.vote.voteType==="MUTE_USER"?(s(),a("div",Pe,[l.vote.vote.second?(s(),a("div",Ae,[v[6]||(v[6]=e("span",{class:"reason-label"},"ğŸ’¬ åŸå› ï¼š",-1)),e("span",Re,m(l.isCompact&&l.vote.vote.second.length>30?l.vote.vote.second.substring(0,30)+"...":l.vote.vote.second),1)])):$("",!0)])):$("",!0)],2),e("div",{class:P(["vote-progress-section",{compact:l.isCompact}])},[e("div",De,[e("div",Ne,[l.vote.vote.positiveCount+l.vote.vote.negativeCount>0?(s(),a(B,{key:0},[e("div",{class:"progress-fill-positive",style:se({width:`${r().positive}%`})},null,4),e("div",{class:"progress-fill-negative",style:se({width:`${r().negative}%`})},null,4)],64)):(s(),a("div",xe,v[7]||(v[7]=[e("span",null,"æš‚æ— æŠ•ç¥¨",-1)])))]),e("div",Le,[e("span",Oe,m(r().positive)+"%",1),e("span",Be,m(r().negative)+"%",1)])])],2),!_.value&&ne(M).isAuthenticated?(s(),a("div",{key:0,class:P(["vote-actions-reference",{compact:l.isCompact}])},[e("div",Fe,[e("button",{class:P(["vote-btn-reference positive-btn",{active:i.value==="POSITIVE",loading:p.value,compact:l.isCompact}]),title:c(l.vote.opinion,!0),onClick:v[0]||(v[0]=T=>O(!0)),disabled:N(!0)||p.value||l.isRefreshing},[v[8]||(v[8]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"18 15 12 9 6 15"})],-1)),l.isCompact?$("",!0):(s(),a("span",je,m(i.value==="POSITIVE"?"å·²æ”¯æŒ":"æ”¯æŒ"),1))],10,He),e("button",{class:P(["vote-btn-reference negative-btn",{active:i.value==="NEGATIVE",loading:p.value,compact:l.isCompact}]),title:c(l.vote.opinion,!1),onClick:v[1]||(v[1]=T=>O(!1)),disabled:N(!1)||p.value||l.isRefreshing},[v[9]||(v[9]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"6 9 12 15 18 9"})],-1)),l.isCompact?$("",!0):(s(),a("span",qe,m(i.value==="NEGATIVE"?"å·²åå¯¹":"åå¯¹"),1))],10,Xe)])],2)):$("",!0),_.value?(s(),a("div",{key:1,class:P(["vote-status-simple",{compact:l.isCompact}])},[e("span",{class:P(["status-text-simple",C.value])},m(b.value>=50?"âœ… å·²é€šè¿‡":"âŒ æœªé€šè¿‡"),3)],2)):$("",!0)],2)}}},Qe=J(Ge,[["__scopeId","data-v-32d0dd11"]]),ze={class:"modal-header"},Je=["disabled"],We={class:"modal-body"},Ye={class:"form-section"},Ke={class:"category-options"},Ze=["onClick"],et={class:"category-icon"},tt={class:"category-info"},st={class:"category-title"},at={class:"category-description"},ot={class:"category-radio"},lt=["value","id"],nt={key:0,class:"form-section"},it={class:"vote-type-options"},rt=["onClick"],ut={class:"option-header"},ct=["value","id"],vt=["for"],dt={class:"option-description"},pt={key:1,class:"form-section"},mt=["disabled"],ft={class:"avatar-upload"},gt=["disabled"],ht={key:0,class:"file-name"},yt={key:2,class:"form-section"},_t={class:"user-search"},bt=["disabled"],Et={key:0,class:"search-results"},kt=["onClick"],Ct=["src","alt"],$t={class:"user-info"},wt={class:"user-name"},Tt={class:"user-username"},St={key:1,class:"selected-user"},It=["src","alt"],Ut={class:"user-info"},Mt={class:"user-name"},Vt={class:"user-username"},Pt=["disabled"],At={class:"form-label"},Rt=["placeholder","disabled"],Dt={key:3,class:"error-message"},Nt={class:"modal-footer"},xt=["disabled"],Lt=["disabled"],Ot={key:0},Bt={key:1},Ft={__name:"CreateVoteModal",props:{spaceId:{type:Number,required:!0},spaceInfo:{type:Object,required:!1,default:()=>({})}},emits:["vote-created","cancel"],setup(l,{emit:A}){const d=l,U=A;ae();const M=[{value:"space_management",label:"ç©ºé—´ç®¡ç†",description:"ä¿®æ”¹ç©ºé—´ä¿¡æ¯ã€æè¿°æˆ–å¤´åƒ",icon:"ğŸ "},{value:"user_moderation",label:"ç”¨æˆ·ç®¡ç†",description:"å¤„ç†è¿è§„ç”¨æˆ·è¡Œä¸º",icon:"ğŸ‘¥"}],p={space_management:[{value:"UPDATE_SPACE",label:"ä¿®æ”¹ç©ºé—´ä¿¡æ¯",description:"æ›´æ”¹ç©ºé—´æè¿°æˆ–å¤´åƒ"}],user_moderation:[{value:"MUTE_USER",label:"ç¦è¨€ç”¨æˆ·",description:"ç¦æ­¢ç”¨æˆ·åœ¨ç©ºé—´ä¸­å‘è¨€"},{value:"EXPEL_USER",label:"é©±é€ç”¨æˆ·",description:"å°†ç”¨æˆ·ä»ç©ºé—´ä¸­ç§»é™¤"}]},k=E(""),f=E(""),b=E(!1),C=E(""),_=E({description:"",avatarFile:null}),i=E({searchQuery:"",selectedUser:null,reason:"",searchResults:[],isSearching:!1}),N=x(()=>k.value?p[k.value]||[]:[]),y=x(()=>{if(!f.value||b.value)return!1;switch(f.value){case"UPDATE_SPACE":return _.value.description.trim()||_.value.avatarFile;case"MUTE_USER":case"EXPEL_USER":return i.value.selectedUser&&i.value.reason.trim();default:return!1}});ie(k,()=>{f.value="",C.value=""}),K(()=>{S()});const S=()=>{var t;k.value="",f.value="",C.value="",_.value={description:((t=d.spaceInfo)==null?void 0:t.description)||"",avatarFile:null},i.value={searchQuery:"",selectedUser:null,reason:"",searchResults:[],isSearching:!1}},V=t=>{const c=t.target.files[0];if(c){if(c.size>5*1024*1024){C.value="å›¾ç‰‡æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB";return}if(!c.type.startsWith("image/")){C.value="è¯·é€‰æ‹©æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶";return}_.value.avatarFile=c,C.value=""}},L=async()=>{var c;const t=i.value.searchQuery.trim();if(!t){i.value.searchResults=[];return}try{i.value.isSearching=!0;const r=await H.getSpaceMembers(d.spaceId,t,0,10);r.success&&((c=r.data)!=null&&c.data)?i.value.searchResults=r.data.data:i.value.searchResults=[]}catch(r){console.error("æœç´¢ç”¨æˆ·å¤±è´¥:",r),i.value.searchResults=[]}finally{i.value.isSearching=!1}},O=t=>{i.value.selectedUser=t,i.value.searchQuery=t.username,i.value.searchResults=[]},F=()=>{i.value.selectedUser=null,i.value.searchQuery="",i.value.searchResults=[]},j=async()=>{var t;if(y.value)try{b.value=!0,C.value="";let c;switch(f.value){case"UPDATE_SPACE":c=await G.createSpaceUpdateVote({spaceId:d.spaceId,description:_.value.description,avatar:_.value.avatarFile,oldAvatar:((t=d.spaceInfo)==null?void 0:t.avatar)||""});break;case"MUTE_USER":c=await G.createMuteUserVote({spaceId:d.spaceId,userId:i.value.selectedUser.userId,username:i.value.selectedUser.username,reason:i.value.reason});break;case"EXPEL_USER":c=await G.createExpelUserVote({spaceId:d.spaceId,userId:i.value.selectedUser.userId,username:i.value.selectedUser.username,reason:i.value.reason});break}c.success?(U("vote-created"),U("cancel")):C.value=c.message||"å‘èµ·æŠ•ç¥¨å¤±è´¥"}catch(c){console.error("å‘èµ·æŠ•ç¥¨å¤±è´¥:",c),C.value=c.message||"å‘èµ·æŠ•ç¥¨å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"}finally{b.value=!1}},h=()=>{b.value||U("cancel")};return(t,c)=>(s(),a("div",{class:"modal-overlay",onClick:h},[e("div",{class:"modal-content",onClick:c[5]||(c[5]=ue(()=>{},["stop"]))},[e("div",ze,[c[7]||(c[7]=e("h3",null,"å‘èµ·æŠ•ç¥¨",-1)),e("button",{class:"close-btn",onClick:h,disabled:b.value},c[6]||(c[6]=[e("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Je)]),e("div",We,[e("div",Ye,[c[8]||(c[8]=e("label",{class:"form-label"},"é€‰æ‹©æŠ•ç¥¨ç±»åˆ«",-1)),e("div",Ke,[(s(),a(B,null,q(M,r=>e("div",{key:r.value,class:P(["category-option",{selected:k.value===r.value}]),onClick:n=>k.value=r.value},[e("div",et,m(r.icon),1),e("div",tt,[e("h4",st,m(r.label),1),e("p",at,m(r.description),1)]),e("div",ot,[z(e("input",{type:"radio",value:r.value,"onUpdate:modelValue":c[0]||(c[0]=n=>k.value=n),id:`category-${r.value}`},null,8,lt),[[oe,k.value]])])],10,Ze)),64))])]),k.value?(s(),a("div",nt,[c[9]||(c[9]=e("label",{class:"form-label"},"é€‰æ‹©å…·ä½“ç±»å‹",-1)),e("div",it,[(s(!0),a(B,null,q(N.value,r=>(s(),a("div",{key:r.value,class:P(["vote-type-option",{selected:f.value===r.value}]),onClick:n=>f.value=r.value},[e("div",ut,[z(e("input",{type:"radio",value:r.value,"onUpdate:modelValue":c[1]||(c[1]=n=>f.value=n),id:r.value},null,8,ct),[[oe,f.value]]),e("label",{for:r.value,class:"option-title"},m(r.label),9,vt)]),e("p",dt,m(r.description),1)],10,rt))),128))])])):$("",!0),f.value==="UPDATE_SPACE"?(s(),a("div",pt,[c[11]||(c[11]=e("label",{class:"form-label"},"æ–°çš„ç©ºé—´æè¿°",-1)),z(e("textarea",{"onUpdate:modelValue":c[2]||(c[2]=r=>_.value.description=r),class:"form-textarea",placeholder:"è¾“å…¥æ–°çš„ç©ºé—´æè¿°...",rows:"4",disabled:b.value},null,8,mt),[[ee,_.value.description]]),c[12]||(c[12]=e("label",{class:"form-label"},"æ›´æ¢å¤´åƒï¼ˆå¯é€‰ï¼‰",-1)),e("div",ft,[e("input",{type:"file",id:"avatar-upload",accept:"image/*",onChange:V,class:"file-input",disabled:b.value},null,40,gt),c[10]||(c[10]=e("label",{for:"avatar-upload",class:"upload-label"},[e("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16"},[e("path",{d:"M8 0a.5.5 0 0 1 .5.5v7h7a.5.5 0 0 1 0 1h-7v7a.5.5 0 0 1-1 0v-7h-7a.5.5 0 0 1 0-1h7v-7A.5.5 0 0 1 8 0z"})]),Q(" é€‰æ‹©å›¾ç‰‡ ")],-1)),_.value.avatarFile?(s(),a("span",ht,m(_.value.avatarFile.name),1)):$("",!0)])])):$("",!0),f.value==="MUTE_USER"||f.value==="EXPEL_USER"?(s(),a("div",yt,[c[13]||(c[13]=e("label",{class:"form-label"},"é€‰æ‹©ç”¨æˆ·",-1)),e("div",_t,[z(e("input",{"onUpdate:modelValue":c[3]||(c[3]=r=>i.value.searchQuery=r),onInput:L,type:"text",class:"form-input",placeholder:"æœç´¢ç”¨æˆ·å...",disabled:b.value},null,40,bt),[[ee,i.value.searchQuery]]),i.value.searchResults.length>0?(s(),a("div",Et,[(s(!0),a(B,null,q(i.value.searchResults,r=>(s(),a("div",{key:r.userId,class:"search-result-item",onClick:n=>O(r)},[e("img",{src:r.avatar,alt:r.nickname,class:"user-avatar"},null,8,Ct),e("div",$t,[e("span",wt,m(r.nickname),1),e("span",Tt,"@"+m(r.username),1)])],8,kt))),128))])):$("",!0),i.value.selectedUser?(s(),a("div",St,[e("img",{src:i.value.selectedUser.avatar,alt:i.value.selectedUser.nickname,class:"user-avatar"},null,8,It),e("div",Ut,[e("span",Mt,m(i.value.selectedUser.nickname),1),e("span",Vt,"@"+m(i.value.selectedUser.username),1)]),e("button",{class:"remove-user-btn",onClick:F,disabled:b.value}," Ã— ",8,Pt)])):$("",!0)]),e("label",At,m(f.value==="MUTE_USER"?"ç¦è¨€":"é©±é€")+"åŸå› ",1),z(e("textarea",{"onUpdate:modelValue":c[4]||(c[4]=r=>i.value.reason=r),class:"form-textarea",placeholder:`è¯´æ˜${f.value==="MUTE_USER"?"ç¦è¨€":"é©±é€"}æ­¤ç”¨æˆ·çš„åŸå› ...`,rows:"3",disabled:b.value},null,8,Rt),[[ee,i.value.reason]])])):$("",!0),C.value?(s(),a("div",Dt,m(C.value),1)):$("",!0)]),e("div",Nt,[e("button",{class:"cancel-btn",onClick:h,disabled:b.value}," å–æ¶ˆ ",8,xt),e("button",{class:P(["submit-btn",{loading:b.value}]),onClick:j,disabled:!y.value},[b.value?(s(),a("span",Ot,"æäº¤ä¸­...")):(s(),a("span",Bt,"å‘èµ·æŠ•ç¥¨"))],10,Lt)])])]))}},Ht=J(Ft,[["__scopeId","data-v-0d80d48e"]]),jt={class:"vote-sidebar-container"},Xt={class:"message-content"},qt={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Gt={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Qt={class:"sidebar-header"},zt={class:"header-info"},Jt={key:0,class:"stats-compact"},Wt={class:"stat-number"},Yt={class:"stat-label"},Kt=["disabled"],Zt={class:"filter-tabs"},es=["onClick"],ts={key:1,class:"loading-state-compact"},ss={key:2,class:"error-state-compact"},as={class:"error-message-compact"},os={key:0,class:"error-debug-info"},ls={class:"debug-details"},ns={class:"debug-content"},is={key:3,class:"empty-state-compact"},rs={class:"empty-message"},us={key:4,class:"vote-list-compact"},cs={key:0,class:"refreshing-indicator"},vs={__name:"VoteList",props:{spaceId:{type:Number,required:!0},isSidebar:{type:Boolean,default:!0}},setup(l){const A=l,d=E([]),U=E(!1),M=E(!1),p=E(null),k=E(!1),f=E("all"),b=E(""),C=E("");let _=null;const i=(h,t="success")=>{b.value=h,C.value=t,_&&clearTimeout(_),_=setTimeout(()=>{b.value="",C.value=""},3e3)},N=[{value:"all",label:"å…¨éƒ¨"},{value:"space_management",label:"ç©ºé—´ç®¡ç†"},{value:"user_management",label:"ç”¨æˆ·ç®¡ç†"}],y=x(()=>{const h=new Date;return d.value.filter(t=>new Date(t.vote.endAt)>h)}),S=x(()=>f.value==="all"?y.value:y.value.filter(h=>{const t=h.vote.voteType;switch(f.value){case"space_management":return t==="UPDATE_SPACE";case"user_management":return["EXPEL_USER","MUTE_USER"].includes(t);default:return!0}})),V=x(()=>({total:y.value.length,filtered:S.value.length})),L=async()=>{try{if(U.value=!0,p.value=null,!A.spaceId||A.spaceId<=0)throw new Error("æ— æ•ˆçš„ç©ºé—´ID");const h=await G.getSpaceVotes(A.spaceId);if(h.success&&h.data)d.value=G.parseSpaceVotes(h.data),d.value.sort((t,c)=>new Date(c.vote.startAt)-new Date(t.vote.startAt));else{const t=h.message||"è·å–æŠ•ç¥¨æ•°æ®å¤±è´¥";console.error("VoteList: APIè¿”å›å¤±è´¥çŠ¶æ€",{response:h,message:t}),p.value=t}}catch(h){console.error("VoteList: è·å–æŠ•ç¥¨å¤±è´¥",{error:h,message:h.message,status:h.status,spaceId:A.spaceId});let t="ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•";h.status===400?t="è¯·æ±‚å‚æ•°é”™è¯¯ï¼Œè¯·æ£€æŸ¥ç©ºé—´ID":h.status===401?t="è¯·å…ˆç™»å½•":h.status===403?t="æ²¡æœ‰æƒé™æŸ¥çœ‹æ­¤ç©ºé—´çš„æŠ•ç¥¨":h.status===404?t="ç©ºé—´ä¸å­˜åœ¨æˆ–æ²¡æœ‰æŠ•ç¥¨":h.status>=500?t="æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•":h.message&&(t=h.message),p.value=t}finally{U.value=!1}},O=h=>{h.success?i(h.message||"æŠ•ç¥¨æˆåŠŸ","success"):i(h.message||"æŠ•ç¥¨å¤±è´¥","error")},F=()=>{k.value=!1,M.value=!0,setTimeout(()=>{L().finally(()=>{M.value=!1})},1e3)},j=()=>{L()};return K(()=>{L()}),(h,t)=>{var c;return s(),a("div",jt,[b.value?(s(),a("div",{key:0,class:P(["message-toast",`message-${C.value}`])},[e("div",Xt,[C.value==="success"?(s(),a("svg",qt,t[3]||(t[3]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)]))):C.value==="error"?(s(),a("svg",Gt,t[4]||(t[4]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("line",{x1:"15",y1:"9",x2:"9",y2:"15"},null,-1),e("line",{x1:"9",y1:"9",x2:"15",y2:"15"},null,-1)]))):$("",!0),e("span",null,m(b.value),1)])],2)):$("",!0),e("div",Qt,[e("div",zt,[t[5]||(t[5]=e("h4",{class:"sidebar-title"},"ç©ºé—´æŠ•ç¥¨",-1)),V.value.total>0?(s(),a("div",Jt,[e("span",Wt,m(V.value.filtered),1),e("span",Yt,m(f.value==="all"?"è¿›è¡Œä¸­":"å½“å‰åˆ†ç±»"),1)])):$("",!0)]),e("button",{class:"create-vote-btn-compact",onClick:t[0]||(t[0]=r=>k.value=!0),disabled:U.value,title:"å‘èµ·æ–°æŠ•ç¥¨"},t[6]||(t[6]=[e("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16"},[e("path",{d:"M8 0a.5.5 0 0 1 .5.5v7h7a.5.5 0 0 1 0 1h-7v7a.5.5 0 0 1-1 0v-7h-7a.5.5 0 0 1 0-1h7v-7A.5.5 0 0 1 8 0z"})],-1)]),8,Kt)]),e("div",Zt,[(s(),a(B,null,q(N,r=>e("button",{key:r.value,class:P(["filter-tab",{active:f.value===r.value}]),onClick:n=>f.value=r.value},m(r.label),11,es)),64))]),U.value?(s(),a("div",ts,t[7]||(t[7]=[e("div",{class:"loading-spinner-small"},null,-1),e("p",null,"åŠ è½½ä¸­...",-1)]))):p.value?(s(),a("div",ss,[t[13]||(t[13]=e("div",{class:"error-icon-small"},"âš ï¸",-1)),e("p",as,m(p.value),1),p.value.includes("è¯·æ±‚å‚æ•°é”™è¯¯")||p.value.includes("Bad Request")?(s(),a("div",os,[e("details",ls,[t[12]||(t[12]=e("summary",{class:"debug-summary"},"è°ƒè¯•ä¿¡æ¯",-1)),e("div",ns,[e("p",null,[t[8]||(t[8]=e("strong",null,"ç©ºé—´ID:",-1)),Q(" "+m(l.spaceId)+" (ç±»å‹: "+m(typeof l.spaceId)+")",1)]),e("p",null,[t[9]||(t[9]=e("strong",null,"è¯·æ±‚URL:",-1)),Q(" /vote/space?spaceId="+m(l.spaceId),1)]),t[10]||(t[10]=e("p",null,[e("strong",null,"å¯èƒ½åŸå› :")],-1)),t[11]||(t[11]=e("ul",null,[e("li",null,"ç©ºé—´IDæ— æ•ˆæˆ–ä¸å­˜åœ¨"),e("li",null,"æ²¡æœ‰æƒé™è®¿é—®æ­¤ç©ºé—´çš„æŠ•ç¥¨"),e("li",null,"åç«¯æœåŠ¡å¼‚å¸¸")],-1))])])])):$("",!0),e("button",{class:"retry-btn-small",onClick:j},"é‡è¯•")])):S.value.length===0?(s(),a("div",is,[t[14]||(t[14]=e("div",{class:"empty-icon-small"},"ğŸ—³ï¸",-1)),e("p",rs,m(f.value==="all"?"æš‚æ— è¿›è¡Œä¸­çš„æŠ•ç¥¨":`æš‚æ— ${(c=N.find(r=>r.value===f.value))==null?void 0:c.label}ç›¸å…³æŠ•ç¥¨`),1),e("button",{class:"create-first-vote-btn",onClick:t[1]||(t[1]=r=>k.value=!0)},"å‘èµ·æŠ•ç¥¨")])):(s(),a("div",us,[M.value?(s(),a("div",cs,t[15]||(t[15]=[e("div",{class:"refresh-spinner"},null,-1),e("span",{class:"refresh-text"},"æ­£åœ¨åŒæ­¥æœ€æ–°æ•°æ®...",-1)]))):$("",!0),(s(!0),a(B,null,q(S.value,r=>(s(),Y(Qe,{key:r.vote.id,vote:r,"space-id":l.spaceId,"is-compact":!0,"is-refreshing":M.value,onVoteCast:O},null,8,["vote","space-id","is-refreshing"]))),128))])),k.value?(s(),Y(Ht,{key:5,"space-id":l.spaceId,onCancel:t[2]||(t[2]=r=>k.value=!1),onVoteCreated:F},null,8,["space-id"])):$("",!0)])}}},ds=J(vs,[["__scopeId","data-v-0fa2c97d"]]),ps={class:"space-members-container"},ms={class:"members-header"},fs={key:0,class:"members-count"},gs={key:0,class:"loading-state"},hs={key:1,class:"error-state"},ys={key:2,class:"members-grid"},_s=["title","onClick"],bs=["src","alt"],Es=["title"],ks={class:"more-count"},Cs={key:3,class:"empty-state"},$s={__name:"SpaceMembers",props:{spaceId:{type:Number,required:!0},maxDisplay:{type:Number,default:15}},setup(l){const A=l,d=re(),U=E([]),M=E(!1),p=E(null),k=E(0),f=x(()=>U.value.slice(0,A.maxDisplay)),b=x(()=>{const y=k.value-A.maxDisplay;return y>0?y:0}),C=async()=>{try{M.value=!0,p.value=null;const y=await H.getSpaceMembers(A.spaceId,"",0,A.maxDisplay+5);if(y.success&&y.data)U.value=y.data.data||[],k.value=U.value.length;else throw new Error(y.message||"è·å–æˆå‘˜åˆ—è¡¨å¤±è´¥")}catch(y){console.error("è·å–ç©ºé—´æˆå‘˜å¤±è´¥:",y),p.value=y.message||"åŠ è½½å¤±è´¥"}finally{M.value=!1}},_=y=>{y.userId&&d.push(`/user/${y.userId}`)},i=y=>y.avatar||"/default-avatar.svg",N=y=>y.nickname||y.username||"æœªçŸ¥ç”¨æˆ·";return K(()=>{C()}),(y,S)=>(s(),a("div",ps,[e("div",ms,[S[0]||(S[0]=ce('<h4 class="members-title" data-v-8e68bb01><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-8e68bb01><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" data-v-8e68bb01></path><circle cx="9" cy="7" r="4" data-v-8e68bb01></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87" data-v-8e68bb01></path><path d="M16 3.13a4 4 0 0 1 0 7.75" data-v-8e68bb01></path></svg> ç©ºé—´æˆå‘˜ </h4>',1)),k.value>0?(s(),a("div",fs,m(k.value),1)):$("",!0)]),M.value?(s(),a("div",gs,S[1]||(S[1]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"åŠ è½½ä¸­...",-1)]))):p.value?(s(),a("div",hs,[S[2]||(S[2]=e("div",{class:"error-icon"},"âš ï¸",-1)),e("p",null,m(p.value),1),e("button",{onClick:C,class:"retry-btn"},"é‡è¯•")])):f.value.length>0?(s(),a("div",ys,[(s(!0),a(B,null,q(f.value,V=>(s(),a("div",{key:V.id,class:"member-avatar",title:N(V),onClick:L=>_(V)},[e("img",{src:i(V),alt:N(V),class:"avatar-image"},null,8,bs)],8,_s))),128)),b.value>0?(s(),a("div",{key:0,class:"more-members",title:`è¿˜æœ‰ ${b.value} ä½æˆå‘˜`},[e("span",ks,"+"+m(b.value),1)],8,Es)):$("",!0)])):(s(),a("div",Cs,S[3]||(S[3]=[e("div",{class:"empty-icon"},"ğŸ‘¥",-1),e("p",null,"æš‚æ— æˆå‘˜ä¿¡æ¯",-1)])))]))}},ws=J($s,[["__scopeId","data-v-8e68bb01"]]),Ts={class:"subblock-container"},Ss={key:0,class:"loading-container"},Is={key:1,class:"error-container"},Us={class:"error-actions"},Ms={key:2,class:"not-found-container"},Vs={key:3,class:"subblock-content"},Ps={class:"subblock-header"},As={class:"header-content"},Rs={class:"space-info"},Ds=["src","alt"],Ns={class:"space-details"},xs={class:"space-name"},Ls={class:"space-display-name"},Os={class:"space-description"},Bs={class:"space-stats"},Fs={class:"stat"},Hs={class:"stat"},js={class:"space-actions"},Xs=["disabled"],qs={key:0},Gs={key:1},Qs={key:2},zs={class:"main-content"},Js={class:"posts-container"},Ws={key:0,class:"loading-container"},Ys={key:0,class:"no-posts"},Ks={key:1,class:"posts-list"},Zs={key:0,class:"infinite-loading-indicator"},ea={key:1,class:"end-indicator"},ta={class:"sidebar"},sa={__name:"Subblock",setup(l){const A=ve(),d=re(),U=ae(),M=E(!0),p=E(null),k=E(!1),f=E(null),b=E(!1),C=E(!1),_=E([]),i=E(0),N=E(0),y=E(!1),S=E(!0);let V=null,L=null;const O=x(()=>A.params.spaceId),F=async()=>{try{f.value=null;const u=await le.get(`/post/space?spaceId=${O.value}&page=${i.value}&direction=ASC`);_.value=u.data.data.map(o=>{var g;return{...o,post:{...o.post,spaceId:O.value,spaceName:((g=p.value)==null?void 0:g.name)||"æœªçŸ¥ç©ºé—´"}}}),i.value=u.data.currentPage,N.value=u.data.totalPage,S.value=i.value<N.value-1}catch(u){console.error("è·å–å¸–å­æ•°æ®å¤±è´¥:",u),f.value=u.message||"åŠ è½½å¸–å­å¤±è´¥"}},j=async()=>{if(!(y.value||!S.value)){y.value=!0;try{const u=i.value+1,o=await le.get(`/post/space?spaceId=${O.value}&page=${u}&direction=ASC`),g=o.data.data.map(R=>{var T;return{...R,post:{...R.post,spaceId:O.value,spaceName:((T=p.value)==null?void 0:T.name)||"æœªçŸ¥ç©ºé—´"}}});_.value=[..._.value,...g],i.value=o.data.currentPage,N.value=o.data.totalPage,S.value=i.value<N.value-1}catch(u){console.error("åŠ è½½æ›´å¤šå¸–å­å¤±è´¥:",u)}finally{y.value=!1}}},h=()=>{if(y.value||!S.value)return;const u=window.scrollY||document.documentElement.scrollTop,o=window.innerHeight;document.documentElement.scrollHeight-u-o<200&&(L&&clearTimeout(L),L=setTimeout(()=>{j()},100))},t=()=>{V||(V=requestAnimationFrame(()=>{h(),V=null}))},c=(u,o)=>{_.value[u].post=o},r=(u,o)=>{_.value[u].opinion=o},n=(u,o)=>{_.value[u].vote=o},v=async()=>{try{M.value=!0,f.value=null,k.value=!1;const u=parseInt(O.value);if(!u||isNaN(u)){k.value=!0,console.warn(`æ— æ•ˆçš„ç©ºé—´ID: "${O.value}"`);return}const o=await H.getSpaceInfo(u);if(o.success&&o.data){p.value=H.parseSpaceData(o.data),p.value.memberCount===0&&p.value.isMember&&(p.value.memberCount=1),await F();try{await H.getSpaceVotes(u)}catch(g){console.warn("åŠ è½½ç©ºé—´æŠ•ç¥¨å¤±è´¥:",g)}}else throw new Error(o.message||"è·å–ç©ºé—´ä¿¡æ¯å¤±è´¥")}catch(u){console.error("åŠ è½½ç©ºé—´æ•°æ®å¤±è´¥:",u),f.value=u.message||"åŠ è½½å¤±è´¥",k.value=!0,_.value=[]}finally{M.value=!1}},I=async(u,o)=>{try{const g=await H.getSpaceInfo(u);return g.success&&g.data?g.data.isMember===o?!0:(console.warn("çŠ¶æ€éªŒè¯å¤±è´¥ï¼ŒæœåŠ¡å™¨çŠ¶æ€ä¸é¢„æœŸä¸ç¬¦"),!1):!1}catch(g){return console.warn("éªŒè¯æˆå‘˜çŠ¶æ€å¤±è´¥:",g),!1}},w=async()=>{if(!p.value||!U.isAuthenticated){U.isAuthenticated||d.push("/login");return}try{const u=p.value.isMember,o=p.value.id;if(f.value=null,u){C.value=!0;const g=await H.leaveSpace(o);if(g.success)await new Promise(R=>setTimeout(R,500)),await v();else if(g.message&&g.message.includes("å°šæœªåŠ å…¥"))console.warn("æ£€æµ‹åˆ°çŠ¶æ€ä¸ä¸€è‡´ï¼šUIæ˜¾ç¤ºå·²åŠ å…¥ï¼Œä½†æœåŠ¡å™¨æ˜¾ç¤ºæœªåŠ å…¥"),f.value="æ£€æµ‹åˆ°çŠ¶æ€ä¸ä¸€è‡´ï¼Œæ­£åœ¨åŒæ­¥...",await v(),f.value=null;else throw new Error(g.message||"ç¦»å¼€ç©ºé—´å¤±è´¥")}else{b.value=!0;const g=await H.joinSpace(o);if(g.success)await new Promise(T=>setTimeout(T,500)),await v(),await I(o,!0)?p.value.memberCount===0&&p.value.isMember&&(p.value.memberCount=1):(console.warn("åŠ å…¥æ“ä½œå¯èƒ½æœªå®Œå…¨æˆåŠŸï¼Œå»ºè®®åˆ·æ–°é¡µé¢"),f.value="åŠ å…¥æ“ä½œå¯èƒ½æœªå®Œå…¨æˆåŠŸï¼Œå¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·åˆ·æ–°é¡µé¢");else throw new Error(g.message||"åŠ å…¥ç©ºé—´å¤±è´¥")}}catch(u){console.error("ç©ºé—´æ“ä½œå¤±è´¥:",u);let o="æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";if(u.message)o=u.message;else if(u.status===401){o="ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•",d.push("/login");return}else u.status===403?o="æ²¡æœ‰æƒé™æ‰§è¡Œæ­¤æ“ä½œ":u.status===404?o="ç©ºé—´ä¸å­˜åœ¨":u.status>=500&&(o="æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•");f.value=o;try{await v()}catch(g){console.warn("é‡æ–°åŠ è½½ç©ºé—´æ•°æ®å¤±è´¥:",g)}}finally{b.value=!1,C.value=!1}};return ie(()=>A.params.spaceId,u=>{u&&v()},{immediate:!0}),K(()=>{v(),window.addEventListener("scroll",t,{passive:!0})}),de(()=>{window.removeEventListener("scroll",t),V&&cancelAnimationFrame(V),L&&clearTimeout(L)}),(u,o)=>{var R;const g=pe("router-link");return s(),a("div",Ts,[M.value?(s(),a("div",Ss,o[1]||(o[1]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"æ­£åœ¨åŠ è½½ç©ºé—´ä¿¡æ¯...",-1)]))):f.value?(s(),a("div",Is,[o[2]||(o[2]=e("h2",null,"æ“ä½œæç¤º",-1)),e("p",null,m(f.value),1),e("div",Us,[e("button",{onClick:v,class:"retry-btn"},"åˆ·æ–°çŠ¶æ€"),e("button",{onClick:o[0]||(o[0]=T=>f.value=null),class:"dismiss-btn"},"å…³é—­æç¤º")])])):k.value?(s(),a("div",Ms,[o[4]||(o[4]=e("h2",null,"ç©ºé—´ä¸å­˜åœ¨",-1)),e("p",null,'æœªæ‰¾åˆ°åä¸º "'+m(O.value)+'" çš„ç©ºé—´',1),W(g,{to:"/",class:"back-home-btn"},{default:te(()=>o[3]||(o[3]=[Q("è¿”å›é¦–é¡µ")])),_:1})])):p.value?(s(),a("div",Vs,[e("div",Ps,[e("div",{class:"header-background",style:se({backgroundColor:p.value.color})},null,4),e("div",As,[e("div",Rs,[e("img",{src:p.value.avatar||p.value.icon,alt:p.value.displayName,class:"space-avatar"},null,8,Ds),e("div",Ns,[e("h1",xs,"r/"+m(p.value.name),1),e("h2",Ls,m(p.value.displayName),1),e("p",Os,m(p.value.description),1),e("div",Bs,[e("span",Fs,m((R=p.value.memberCount)==null?void 0:R.toLocaleString())+" æˆå‘˜",1),e("span",Hs,m(p.value.postCount||_.value.length)+" å¸–å­",1)])])]),e("div",js,[ne(U).isAuthenticated?(s(),a("button",{key:0,onClick:w,disabled:b.value||C.value,class:P(["join-btn",{joined:p.value.isMember,joining:b.value,leaving:C.value}])},[b.value?(s(),a("span",qs,"åŠ å…¥ä¸­...")):C.value?(s(),a("span",Gs,"ç¦»å¼€ä¸­...")):(s(),a("span",Qs,m(p.value.isMember?"å·²åŠ å…¥":"åŠ å…¥"),1))],10,Xs)):(s(),Y(g,{key:1,to:"/login",class:"login-prompt-btn"},{default:te(()=>o[5]||(o[5]=[Q(" ç™»å½•ååŠ å…¥ ")])),_:1}))])])]),e("div",zs,[e("div",Js,[M.value?(s(),a("div",Ws,o[6]||(o[6]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"åŠ è½½å¸–å­ä¸­...",-1)]))):(s(),a(B,{key:1},[_.value.length===0?(s(),a("div",Ys,[o[8]||(o[8]=e("p",null,"è¿™ä¸ªç©ºé—´è¿˜æ²¡æœ‰å¸–å­",-1)),W(g,{to:"/submit",class:"create-post-btn"},{default:te(()=>o[7]||(o[7]=[Q("å‘å¸ƒç¬¬ä¸€ä¸ªå¸–å­")])),_:1})])):(s(),a("div",Ks,[(s(!0),a(B,null,q(_.value,(T,D)=>(s(),Y(me,{key:T.post.id,post:T.post,user:T.user,opinion:T.opinion,vote:T.vote,"onUpdate:post":X=>c(D,X),"onUpdate:opinion":X=>r(D,X),"onUpdate:vote":X=>n(D,X)},null,8,["post","user","opinion","vote","onUpdate:post","onUpdate:opinion","onUpdate:vote"]))),128)),S.value&&y.value?(s(),a("div",Zs,o[9]||(o[9]=[e("div",{class:"loading-spinner small"},null,-1),e("span",null,"åŠ è½½æ›´å¤šå¸–å­...",-1)]))):$("",!0),!S.value&&_.value.length>0?(s(),a("div",ea,o[10]||(o[10]=[e("span",null,"å·²ç»åˆ°åº•äº†~",-1)]))):$("",!0)]))],64))]),e("div",ta,[W(ws,{"space-id":p.value.id},null,8,["space-id"]),W(ds,{"space-id":p.value.id},null,8,["space-id"])])])])):$("",!0)])}}},na=J(sa,[["__scopeId","data-v-34dd85fd"]]);export{na as default};
