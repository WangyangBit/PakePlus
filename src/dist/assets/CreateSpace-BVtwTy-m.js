import{_ as V,u as A,r as v,l as I,o as j,B as F,c as o,b as i,d as a,C as U,z,h as u,s as k,y,n as _,t as r,f as h,e as P,w as R,g as T,A as g}from"./index-CQU0DmQk.js";const $={class:"create-space-layout"},E={class:"main-content"},G={class:"create-space-container"},H={class:"form-group"},q={class:"input-wrapper"},J={class:"input-help"},L={class:"char-count"},K={key:0,class:"error-message"},O={class:"form-group"},Q={class:"input-help"},W={class:"char-count"},X={key:0,class:"error-message"},Y={class:"form-group"},Z={class:"avatar-upload-section"},ee={class:"avatar-preview"},ae=["src"],te={key:1,class:"avatar-placeholder"},se={class:"default-avatar"},le={class:"avatar-actions"},oe={key:0,class:"error-message"},ie={key:0,class:"error-alert"},re={class:"form-actions"},ne=["disabled"],ce={key:0,class:"loading-icon",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},de={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},ve={__name:"CreateSpace",setup(ue){const w=F(),D=A(),l=v({spaceName:"",spaceDescription:""}),p=v(null),m=v(""),t=v({spaceName:"",spaceDescription:"",avatar:"",general:""}),d=v(!1),f=I(()=>l.value.spaceName.length>=2&&l.value.spaceDescription.length>=1&&!t.value.spaceName&&!t.value.spaceDescription&&!t.value.avatar),N=()=>{const s=l.value.spaceName.trim();return s.length===0?"r/":"r/"+s.substring(0,2).toUpperCase()},b=()=>{const s=l.value.spaceName;if(t.value.spaceName="",s.length===0)return;const e=g.validateSpaceName(s);e.valid||(t.value.spaceName=e.message)},x=()=>{const s=l.value.spaceDescription;if(t.value.spaceDescription="",s.length===0)return;const e=g.validateSpaceDescription(s);e.valid||(t.value.spaceDescription=e.message)},C=s=>{const e=s.target.files[0];if(!e)return;const c=g.validateAvatarFile(e);if(!c.valid){t.value.avatar=c.message;return}t.value.avatar="",p.value=e;const n=new FileReader;n.onload=M=>{m.value=M.target.result},n.readAsDataURL(e)},S=()=>{p.value=null,m.value="",t.value.avatar="";const s=document.querySelector('input[type="file"]');s&&(s.value="")},B=async()=>{if(t.value.general="",b(),x(),!l.value.spaceDescription.trim()){t.value.spaceDescription="请输入空间描述";return}if(f.value)try{d.value=!0;const s={name:l.value.spaceName.trim(),description:l.value.spaceDescription.trim()},e=await g.createSpace(s,p.value);if(e.success){const c=e.data;w.push(`/r/${c}`)}else throw new Error(e.message||"创建空间失败")}catch(s){console.error("创建空间失败:",s),t.value.general=s.message||"创建空间失败，请稍后重试"}finally{d.value=!1}};return j(()=>{D.isAuthenticated||w.push("/login")}),(s,e)=>{const c=T("router-link");return i(),o("div",$,[a("div",E,[a("div",G,[e[14]||(e[14]=a("div",{class:"header"},[a("h1",null,"创建新空间"),a("p",null,"创建一个属于你的社区空间，与志同道合的人分享内容")],-1)),a("form",{onSubmit:z(B,["prevent"]),class:"space-form"},[a("div",H,[e[5]||(e[5]=a("label",{for:"spaceName",class:"form-label"}," 空间名称 * ",-1)),a("div",q,[e[3]||(e[3]=a("span",{class:"input-prefix"},"r/",-1)),k(a("input",{id:"spaceName","onUpdate:modelValue":e[0]||(e[0]=n=>l.value.spaceName=n),type:"text",class:_(["form-input with-prefix",{error:t.value.spaceName}]),placeholder:"例如：technology, gaming, cooking",maxlength:"50",onInput:b},null,34),[[y,l.value.spaceName]])]),a("div",J,[a("span",L,r(l.value.spaceName.length)+"/50",1),e[4]||(e[4]=a("span",{class:"help-text"},"只能包含字母、数字、中文、下划线和短横线，2-50个字符",-1))]),t.value.spaceName?(i(),o("div",K,r(t.value.spaceName),1)):u("",!0)]),a("div",O,[e[6]||(e[6]=a("label",{for:"spaceDescription",class:"form-label"}," 空间描述 * ",-1)),k(a("textarea",{id:"spaceDescription","onUpdate:modelValue":e[1]||(e[1]=n=>l.value.spaceDescription=n),class:_(["form-textarea",{error:t.value.spaceDescription}]),placeholder:"描述一下这个空间的主题和目的...",rows:"4",maxlength:"500",onInput:x},null,34),[[y,l.value.spaceDescription]]),a("div",Q,[a("span",W,r(l.value.spaceDescription.length)+"/500",1)]),t.value.spaceDescription?(i(),o("div",X,r(t.value.spaceDescription),1)):u("",!0)]),a("div",Y,[e[8]||(e[8]=a("label",{class:"form-label"}," 空间头像 ",-1)),a("div",Z,[a("div",ee,[m.value?(i(),o("img",{key:0,src:m.value,alt:"空间头像预览",class:"avatar-image"},null,8,ae)):(i(),o("div",te,[a("div",se,r(N()),1)]))]),a("div",le,[a("input",{ref:"avatarInput",type:"file",accept:"image/*",onChange:C,style:{display:"none"}},null,544),a("button",{type:"button",class:"upload-btn",onClick:e[2]||(e[2]=n=>s.$refs.avatarInput.click())},e[7]||(e[7]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a("polyline",{points:"17,8 12,3 7,8"}),a("line",{x1:"12",y1:"3",x2:"12",y2:"15"})],-1),h(" 选择头像 ")])),p.value?(i(),o("button",{key:0,type:"button",class:"remove-btn",onClick:S}," 移除 ")):u("",!0)])]),e[9]||(e[9]=a("div",{class:"help-text"},"推荐尺寸：256x256像素，支持JPG、PNG格式，最大5MB。未上传头像将使用默认头像。",-1)),t.value.avatar?(i(),o("div",oe,r(t.value.avatar),1)):u("",!0)]),t.value.general?(i(),o("div",ie,[e[10]||(e[10]=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("circle",{cx:"12",cy:"12",r:"10"}),a("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),a("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1)),h(" "+r(t.value.general),1)])):u("",!0),a("div",re,[P(c,{to:"/",class:"btn-cancel"},{default:R(()=>e[11]||(e[11]=[h("取消")])),_:1}),a("button",{type:"submit",class:"btn-submit",disabled:!f.value||d.value},[d.value?(i(),o("svg",ce,e[12]||(e[12]=[a("path",{d:"M21 12a9 9 0 11-6.219-8.56"},null,-1)]))):(i(),o("svg",de,e[13]||(e[13]=[a("circle",{cx:"12",cy:"12",r:"3"},null,-1),a("path",{d:"M12 1v6m0 6v6"},null,-1),a("path",{d:"m21 12-6 0m-6 0-6 0"},null,-1)]))),h(" "+r(d.value?"创建中...":"创建空间"),1)],8,ne)])],32)])]),e[15]||(e[15]=U('<div class="sidebar" data-v-adc3368b><div class="tips-card" data-v-adc3368b><h3 data-v-adc3368b><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-adc3368b><circle cx="12" cy="12" r="10" data-v-adc3368b></circle><path d="M12 16v-4" data-v-adc3368b></path><path d="M12 8h.01" data-v-adc3368b></path></svg> 创建空间小贴士 </h3><ul class="tips-list" data-v-adc3368b><li data-v-adc3368b>选择一个简洁易记的空间名称</li><li data-v-adc3368b>清晰描述空间的主题和目的</li><li data-v-adc3368b>上传一个有代表性的空间头像</li><li data-v-adc3368b>制定明确的社区规则</li><li data-v-adc3368b>积极参与和管理你的空间</li></ul></div><div class="rules-card" data-v-adc3368b><h3 data-v-adc3368b><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-adc3368b><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-adc3368b></path><path d="M14 2v6h6" data-v-adc3368b></path><line x1="16" y1="13" x2="8" y2="13" data-v-adc3368b></line><line x1="16" y1="17" x2="8" y2="17" data-v-adc3368b></line><line x1="10" y1="9" x2="8" y2="9" data-v-adc3368b></line></svg> 空间规则 </h3><ul class="rules-list" data-v-adc3368b><li data-v-adc3368b>遵守平台社区准则</li><li data-v-adc3368b>不得发布违法违规内容</li><li data-v-adc3368b>尊重其他用户</li><li data-v-adc3368b>保持内容与空间主题相关</li><li data-v-adc3368b>禁止垃圾信息和广告</li></ul></div></div>',1))])}}},me=V(ve,[["__scopeId","data-v-adc3368b"]]);export{me as default};
