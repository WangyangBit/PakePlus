import{_ as tt,B as et,r as y,l as v,g as ot,c as p,b as f,h as T,d as t,n as w,t as u,F as nt,m as V,z as C,e as b,w as M,f as O,p as st,k as _,Q as it,R as x,Y as at}from"./index-CQU0DmQk.js";function lt(n){return typeof n=="object"&&(n!=null&&n.userId)?`/user/${n.userId}`:typeof n=="object"&&(n!=null&&n.username)?`/user/${A(n.username)}`:typeof n=="string"?`/user/${A(n)}`:"#"}function A(n){const I={ÈíìÂõ†ÂÆàÈπ§:"6510615555426900574",coding_expert:"2",webdev_guru:"3",css_wizard:"4",debugger_hero:"5",js_enthusiast:"6",curious_coder:"7",futurist_dev:"8",community_mod:"9"};return I[n]?I[n]:`user_${n.replace(/[^a-zA-Z0-9]/g,"_")}`}function rt(n){return n?`u/${n}`:"u/Êú™Áü•Áî®Êà∑"}const ut={key:0,class:"vote-panel"},vt={class:"vote-container-header"},dt={class:"vote-type-info"},ct={class:"vote-meta"},pt={class:"vote-type-text"},ft={class:"vote-initiator"},gt={class:"vote-stats-section"},wt={class:"vote-stats"},ht={class:"stats-value"},Et={class:"vote-progress-bar-wrapper"},It={class:"vote-progress-bar-dual"},mt={key:1,class:"vote-progress-placeholder"},Tt={class:"vote-progress-stats"},Ct={class:"vote-positive-percentage"},kt={class:"vote-negative-percentage"},yt={key:0,class:"vote-actions"},_t=["disabled"],St=["disabled"],Nt={key:1,class:"vote-expired-notice"},Pt={class:"post-main"},Vt={class:"vote-container"},bt={class:"vote-score"},Mt={class:"post-content"},Ot={class:"post-header"},xt={class:"post-header-left"},At=["src","alt"],Dt={class:"post-metadata"},Ut={class:"post-time"},$t={class:"post-title-container"},jt={class:"post-title"},Bt={key:0,class:"post-archived-badge"},Ht={key:0,class:"post-body"},Rt=["innerHTML"],Lt={class:"post-footer"},Gt={class:"post-action"},zt={__name:"PostCard",props:{post:{type:Object,required:!0},opinion:{type:Object,default:()=>({opinionStatus:null})},user:{type:Object,default:()=>({userId:null,nickname:"Êú™Áü•Áî®Êà∑"})},vote:{type:Object,default:null},compact:{type:Boolean,default:!1}},emits:["update:post","update:opinion","update:vote"],setup(n,{emit:I}){const a=n,D=et(),E=I,d=y({...a.post}),c=y({...a.opinion}),s=y(a.vote?{...a.vote}:null),U=v(()=>d.value.positiveCount-d.value.negativeCount),$=v(()=>lt(a.user)),j=v(()=>{var o;return{voted:((o=c.value)==null?void 0:o.opinionStatus)==="POSITIVE",upvote:!0}}),B=v(()=>{var o;return{voted:((o=c.value)==null?void 0:o.opinionStatus)==="NEGATIVE",downvote:!0}}),H=async o=>{var r;o.stopPropagation();const e=(r=c.value)==null?void 0:r.opinionStatus;e==="NEGATIVE"?(d.value.positiveCount++,d.value.negativeCount--):e!=="POSITIVE"&&d.value.positiveCount++,c.value={...c.value,opinionStatus:"POSITIVE",updatedAt:new Date().toISOString()};try{const i={postId:a.post.id,spaceId:a.post.spaceId,userId:a.user.userId,isPositive:!0},l=await _.post("/opinion/post",i);E("update:post",d.value),E("update:opinion",c.value)}catch(i){console.error("Êèê‰∫§Â§±Ë¥•:",i),d.value={...a.post},c.value={...a.opinion}}},R=async o=>{var r;o.stopPropagation();const e=(r=c.value)==null?void 0:r.opinionStatus;e==="POSITIVE"?(d.value.positiveCount--,d.value.negativeCount++):e!=="NEGATIVE"&&d.value.negativeCount++,c.value={...c.value,opinionStatus:"NEGATIVE",updatedAt:new Date().toISOString()};try{const i={postId:a.post.id,spaceId:a.post.spaceId,userId:a.user.userId,isPositive:!1},l=await _.post("/opinion/post",i);E("update:post",d.value),E("update:opinion",c.value)}catch(i){console.error("Êèê‰∫§Â§±Ë¥•:",i),d.value={...a.post},c.value={...a.opinion}}},S=async o=>{var r,i,l;if(!((i=(r=s.value)==null?void 0:r.vote)!=null&&i.id)||o&&g.value==="POSITIVE"||!o&&g.value==="NEGATIVE")return;const e=(l=s.value.opinion)==null?void 0:l.opinionStatus;o?(e==="NEGATIVE"?(s.value.vote.positiveCount++,s.value.vote.negativeCount--):e==="NIL"&&s.value.vote.positiveCount++,s.value.opinion.opinionStatus="POSITIVE"):(e==="POSITIVE"?(s.value.vote.positiveCount--,s.value.vote.negativeCount++):e==="NIL"&&s.value.vote.negativeCount++,s.value.opinion.opinionStatus="NEGATIVE");try{await _.post("/opinion/vote?isCommon=true",{id:s.value.vote.id,isPositive:o}),E("update:vote",s.value)}catch(m){console.error("ÊäïÁ•®Â§±Ë¥•:",m),s.value=a.vote?{...a.vote}:null}},h=v(()=>{var o;return(o=s.value)!=null&&o.vote?s.value.vote.positiveCount+s.value.vote.negativeCount:0}),k=v(()=>{var o;return!((o=s.value)!=null&&o.vote)||h.value===0?0:(s.value.vote.positiveCount/h.value*100).toFixed(1)}),N=v(()=>{var o;return!((o=s.value)!=null&&o.vote)||h.value===0?0:(s.value.vote.negativeCount/h.value*100).toFixed(1)}),g=v(()=>{var o,e;return(e=(o=s.value)==null?void 0:o.opinion)==null?void 0:e.opinionStatus}),L=()=>{const o=`/r/${a.post.spaceId}/post/${a.post.id}`;D.push(o)},G=o=>{const e=new Date(o);return Math.abs(new Date-e)/36e5<24?it(e,{addSuffix:!0,locale:x}):at(e,"yyyyÂπ¥MMÊúàddÊó• HH:mm",{locale:x})};v(()=>{var o,e;return((e=(o=s.value)==null?void 0:o.opinion)==null?void 0:e.opinionStatus)!=="NIL"});const z=v(()=>g.value==="POSITIVE"),F=v(()=>g.value==="NEGATIVE"),q={PIN_COMMENT:"ÁΩÆÈ°∂ËØÑËÆ∫",UNPIN_COMMENT:"ÂèñÊ∂àÁΩÆÈ°∂ËØÑËÆ∫",DELETE_COMMENT:"Âà†Èô§ËØÑËÆ∫",ARCHIVE_POST:"ÂΩíÊ°£Â∏ñÂ≠ê",UNARCHIVE_POST:"ÂèñÊ∂àÂΩíÊ°£Â∏ñÂ≠ê",DELETE_POST:"Âà†Èô§Â∏ñÂ≠ê",UPDATE_SPACE:"Êõ¥Êñ∞Á©∫Èó¥",EXPEL_USER:"Ë∏¢Âá∫Áî®Êà∑",MUTE_USER:"Á¶ÅË®ÄÁî®Êà∑"};function Q(o){return q[o]||o}const X=o=>({DELETE_POST:"delete",ARCHIVE_POST:"archive",UNARCHIVE_POST:"unarchive",DELETE_COMMENT:"delete",PIN_COMMENT:"pin",UNPIN_COMMENT:"unpin"})[o]||"default",Y=o=>({DELETE_POST:"üóëÔ∏è",ARCHIVE_POST:"üì¶",UNARCHIVE_POST:"üì¶",DELETE_COMMENT:"üóëÔ∏è",PIN_COMMENT:"üìå",UNPIN_COMMENT:"üìå"})[o]||"üó≥Ô∏è",Z=o=>{const i=new Date(o)-new Date;if(i<=0)return"Â∑≤ÁªìÊùü";const l=Math.floor(i/1e3);return l<60?`${l}Áßí`:l<3600?`${Math.floor(l/60)}ÂàÜÈíü`:l<86400?`${Math.floor(l/3600)}Â∞èÊó∂`:`${Math.floor(l/86400)}Â§©`},J=v(()=>{var o,e;return(e=(o=s.value)==null?void 0:o.vote)!=null&&e.endAt?new Date>new Date(s.value.vote.endAt):!0}),K=v(()=>{var i,l;if(!((l=(i=s.value)==null?void 0:i.vote)!=null&&l.endAt))return"";const r=(new Date(s.value.vote.endAt)-new Date)/(1e3*60*60);return r<=0?"expired":r<=1?"urgent":r<=24?"warning":"normal"});return(o,e)=>{var i,l,m,P;const r=ot("router-link");return f(),p("article",{class:w(["post-card",{compact:n.compact}]),onClick:L},[(i=n.vote)!=null&&i.vote?(f(),p("div",ut,[t("div",vt,[t("div",dt,[t("span",{class:w(["vote-type-badge",X(n.vote.vote.voteType)])},u(Y(n.vote.vote.voteType)),3),t("div",ct,[t("div",pt,u(Q(n.vote.vote.voteType)),1),t("div",ft,"ÂèëËµ∑‰∫∫: "+u(((l=n.vote.initiator)==null?void 0:l.username)||((m=n.vote.initiator)==null?void 0:m.nickname)||"Êú™Áü•"),1)])]),t("div",{class:w(["vote-time-remaining",K.value])}," Ââ©‰Ωô "+u(Z(n.vote.vote.endAt)),3)]),t("div",gt,[t("div",wt,[e[4]||(e[4]=t("span",{class:"stats-label"},"ÊäïÁ•®ËøõÂ∫¶",-1)),t("span",ht,u(k.value)+"% ËµûÊàê (ÂÖ± "+u(h.value)+" Á•®)",1)]),t("div",Et,[t("div",It,[h.value>0?(f(),p(nt,{key:0},[t("div",{class:"vote-progress-positive",style:V({width:`${k.value}%`})},null,4),t("div",{class:"vote-progress-negative",style:V({width:`${N.value}%`})},null,4)],64)):(f(),p("div",mt,e[5]||(e[5]=[t("span",null,"ÊöÇÊó†ÊäïÁ•®",-1)])))]),t("div",Tt,[t("span",Ct,u(k.value)+"%",1),t("span",kt,u(N.value)+"%",1)])])]),J.value?(f(),p("div",Nt,e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12 6 12 12 16 14"})],-1),t("span",null,"ÊäïÁ•®Â∑≤ÁªìÊùü",-1)]))):(f(),p("div",yt,[t("button",{class:w(["vote-btn positive-btn",{active:g.value==="POSITIVE"}]),onClick:e[0]||(e[0]=C(W=>S(!0),["stop"])),disabled:z.value},[e[6]||(e[6]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"18 15 12 9 6 15"})],-1)),t("span",null,u(g.value==="POSITIVE"?"Â∑≤ËµûÊàê":"ËµûÊàê"),1)],10,_t),t("button",{class:w(["vote-btn negative-btn",{active:g.value==="NEGATIVE"}]),onClick:e[1]||(e[1]=C(W=>S(!1),["stop"])),disabled:F.value},[e[7]||(e[7]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"6 9 12 15 18 9"})],-1)),t("span",null,u(g.value==="NEGATIVE"?"Â∑≤ÂèçÂØπ":"ÂèçÂØπ"),1)],10,St)]))])):T("",!0),t("div",Pt,[t("div",Vt,[t("button",{class:w(j.value),onClick:H,"aria-label":"Upvote"},e[9]||(e[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"18 15 12 9 6 15"})],-1)]),2),t("div",bt,u(U.value),1),t("button",{class:w(B.value),onClick:R,"aria-label":"Downvote"},e[10]||(e[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"6 9 12 15 18 9"})],-1)]),2)]),t("div",Mt,[t("div",Ot,[t("div",xt,[n.user.avatar?(f(),p("img",{key:0,src:n.user.avatar,alt:n.user.nickname,class:"user-avatar"},null,8,At)):T("",!0),b(r,{to:$.value,class:"author-link",onClick:e[2]||(e[2]=C(()=>{},["stop"]))},{default:M(()=>[O(u(st(rt)(n.user.nickname)),1)]),_:1},8,["to"]),t("span",Dt,[e[11]||(e[11]=t("span",{class:"metadata-divider"},"ÂèëÂ∏É‰∫é",-1)),b(r,{to:`/r/${n.post.spaceId}`,class:"subblock-link",onClick:e[3]||(e[3]=C(()=>{},["stop"]))},{default:M(()=>[O(u(n.post.spaceName||"Êú™ÂëΩÂêçÁ©∫Èó¥"),1)]),_:1},8,["to"]),t("span",Ut,u(G(n.post.createdAt)),1)])])]),t("div",$t,[t("h2",jt,u(n.post.subject),1),n.post.isArchived?(f(),p("div",Bt,e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"21,8 21,21 3,21 3,8"}),t("rect",{x:"1",y:"3",width:"22",height:"5"}),t("line",{x1:"10",y1:"12",x2:"14",y2:"12"})],-1),t("span",null,"Â∑≤ÂΩíÊ°£",-1)]))):T("",!0)]),n.post.content&&!n.compact?(f(),p("div",Ht,[t("p",{innerHTML:(P=n.post)==null?void 0:P.content},null,8,Rt)])):T("",!0),t("div",Lt,[t("div",Gt,[e[13]||(e[13]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})],-1)),t("span",null,u(n.post.commentCount||0)+" ËØÑËÆ∫",1)])])])])],2)}}},qt=tt(zt,[["__scopeId","data-v-544aa20b"]]);export{qt as P,rt as f,lt as g};
